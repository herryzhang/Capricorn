---
layout: blog
title: 'docker自动化部署'
date: 2017-12-20 11:54:20
categories: thinking
tags: thinking
lead_text: '自动化部署'
---

## 一. 背景
自动化部署就是为了解放生产力。

## 二. CI部署
### Jenkins与Github集成

#### Github Hooks
配置Github项目仓库，Github项目仓库在处理这些动作的同时会发送信号至Jenkins触发自动构建操作。

##### 生成Personal Access Token
- 登录[Github](https://github.com)，在头像上点击settings
![settings](deploy/pat1.png)
- 点击Developer settings下的Personal access tokens
![tokens](deploy/pat2.png)
- 点击Generate new token,在Token description中填一个描述名称，下面的复选框是这个token需要的权限，按照需要的权限勾上。
![new_token](deploy/pat3.png)
- token可复制使用
![authority](deploy/pat4.png)

##### 配置Github项目仓库
上面的Token是属于账户级的东西，Webhooks是项目级别的。当项目发生了某个事件，Github会给一个指定的url发Post请求。
- 点击项目仓库的settings
![settings](deploy/webhooks1.png)
- 在Webhooks选项卡中，点击Add webhook
![add webhooks](deploy/webhooks2.png)
- 将在Jenkins生成的Hook URL填入至Payload URL中，选择自主事件,当Github收到了客户端有Push/Pull Request动作时，会触发一个Hook
![jenkins](deploy/webhooks3.png)
- 保存WebHook
![jenkins](deploy/webhooks4.png)

#### Jenkins安装
- [Installing Jenkins on Ubuntu](https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Ubuntu)

#### Jenkins全局配置
![systerm config](deploy/configure_systerm.png)

#### Jenkins项目配置
![project config](deploy/configure_project.png)

## 三. 部署脚本

### Ansible
#### Ansible Playbook

### Docker
#### Docker File
#### Docker镜像
#### Docker Registry
#### Docker Compose

## 三. 优化
## 四. 总结